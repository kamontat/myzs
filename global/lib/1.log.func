#!/usr/bin/env bash

# maintain: Kamontat Chantrachirathumrong
# version:  1.0.0
# since:    27/04/2018

log_to() {
	exec >>"$1"
	while IFS= read -r line; do
		printf '%s\n' "$line"
	done
}

_myzs_show_log() {
	test -n "$MYZS_LOG_FILE" &&
		cat "$MYZS_LOG_FILE"
}

_myzs_show_error() {
	test -n "$MYZS_ERROR_FILE" &&
		cat "$MYZS_ERROR_FILE"
}

_myzs_clear_log() {
	test -n "$MYZS_LOG_FILE" &&
		rm -f "$MYZS_LOG_FILE"
}

_myzs_clear_err() {
	test -n "$MYZS_ERROR_FILE" &&
		rm -f "$MYZS_ERROR_FILE"
}

_myzs_get_uuid() {
	# shellcheck disable=SC2015
	test -n "$LOG_UUID" &&
		echo "$LOG_UUID" ||
		throw "ERROR: UUID not exist!" 10
}

create_sub_log() {
	local uuid=$(_myzs_get_uuid)
	# if
}

_myzs__print() {
	local date_char=15 head_char="${MYZS_HEADER_SIZE:-15}" nl="\n"
	local t="$1"
	shift
	local m="$*"
	test -z "$m" && nl=""
	printf "%-${date_char}s %${head_char}s - %s$nl" "$(date)" "$t" "$m"
}

# 1 - title
# 2 - message
_myzs_if_debug_print() {
	[[ $MYZS_DEBUG_MODE != "debug" ]] &&
		[[ $MYZS_DEBUG_MODE != "full" ]] &&
		return 0

	_myzs__print "$@"
}

_myzs_if_fully_debug_print() {
	[[ $MYZS_DEBUG_MODE != "full" ]] &&
		[[ $MYZS_DEBUG_MODE != "file" ]] &&
		return 0

	_myzs__print "$@" >>"${MYZS_LOG_FILE}"
}

_myzs_if_full_debug_print() {
	_myzs_if_fully_debug_print "$@"
}

_myzs_if_debug_print_error() {
	_myzs_if_debug_print "$@" >&2
}

_myzs_if_fully_debug_print_error() {
	[[ $MYZS_DEBUG_MODE != "full" ]] &&
		return 0

	_myzs__print "$@" >>"${MYZS_ERROR_FILE}"
}

_myzs_if_full_debug_print_error() {
	_myzs_if_fully_debug_print_error "$@"
}
